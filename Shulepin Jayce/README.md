Full credits to Shulepin, I did not write this. Minor & simple changes were made to fix current issues raised
